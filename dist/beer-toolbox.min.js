angular.module("BeerToolbox",["UnitsConversion"]),angular.module("BeerToolbox").service("BeerColor",["UnitsConversion",function(a){"use strict";this.estimateColor=function(b,c){var d,e=0;c.forEach(function(c){d=a.fromTo(c.color,"color.ebc","color.lovibond"),e+=8.34540445202*d*c.mass/b});var f=1.4922*Math.pow(e,.6859),g=a.fromTo(f,"color.srm","color.rgb");return{srm:f,rgb:g}}}]),angular.module("BeerToolbox").service("BeerSugar",["Polynome",function(a){var b=new a({a3:182.4601,a2:-775.6821,a1:1262.7794,a0:-669.5622}),c=new a({a3:135.997,a2:-630.272,a1:1111.14,a0:-616.868});this.densityCorrection=function(a,b,c){return c="undefined"==typeof c?20:c,(a-(c+288.9414)/(508929.2*(c+68.12963))*Math.pow(c-3.9863,2))/(1-(b+288.9414)/(508929.2*(b+68.12963))*Math.pow(b-3.9863,2))},this.gravityToAlcohol=function(a,b,c){return calibrationTemp=calibrationTemp?calibrationTemp:0,1.05*(a-b)/b*100/.795+5e-4*c/.795/10},this.gravityDilution=function(a,b,c,d){d="undefined"==typeof d||0>c?1:d;var e=a+c;return(b*a+d*c)/e},this.mashingVolume=function(a,b){return("undefined"==typeof b?3:b)*a},this.grainRetention=function(a,b){return("undefined"==typeof b?1:b)*a},this.volumeToBoil=function(a,b,c){return b="undefined"==typeof b?.1:b,c="undefined"==typeof c?.05:c,a/((1-b)*(1-c))},this.producedSugar=function(a,b){return b="undefined"==typeof b?.75:b,b*[0].concat(a).reduce(function(a,b){return a+b.mass*b["yield"]/100})},this.brixToSg=function(a){return b.invert(a)},this.sgToBrix=function(a){return b.direct(brix)},this.platoToSg=function(a){return c.invert(a)},this.sgToPlato=function(a){return c.direct(a)},this.sgToAlcohol=function(a){return alcohol/.0076},this.alcoholToSg=function(a){return.0076*a},this.sgToAlcohol=function(a,b){return"undefined"==typeof b&&(b=1+(a-1)/4),(a-b)/.0076},this.diluateSugar=function(a,b,c){c="undefined"==typeof c?.25:c;var d=0!==a?100*b/a:0,e=brixToSg(d),f=1+(e-1)*c,g=sgToAlcohol(e,f),h=sgToPlato(e);return{brixGravity:d,specificGravity:e,residualGravity:f,platoGravity:h,alcohol:g}}}]),angular.module("BeerToolbox").service("Ibu",function(){"use strict";var a={rager:function(a,b,c,d,e){var f=d>1.05?(d-1.05)/.2:0,g=18.109069+13.862039*Math.tanh((e-31.322749)/18.267743);return b*g*a*1e3/(c*(1+f))},tinseth:function(a,b,c,d,e){var f=1.65*Math.pow(125e-6,d-1),g=(1-Math.exp(-.04*e))/4.15,h=f*g;return b*h*a*1e3/c}};this.availableMethods=function(){return Object.keys(a)},this.compute=function(b,c,d){d=angular.extend({precision:null},d);var e=[0].concat(c).reduce(function(c,d){var e=/^pellet/.test(d.type?d.type:"")?1.1:1;return c+a[b](e*d.alphaAcidity/100,d.massGr,d.volumeL,d.gravitySg,d.lastingMin)});if(d.precision&&"number"==typeof e){var f=Math.pow(10,d.precision);return Math.round(e*f)/f}return e}});